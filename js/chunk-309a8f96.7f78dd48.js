(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-309a8f96"],{2163:function(t,e,a){"use strict";a("ee78")},2366:function(t,e){for(var a=[],r=0;r<256;++r)a[r]=(r+256).toString(16).substr(1);function n(t,e){var r=e||0,n=a;return[n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],"-",n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]],n[t[r++]]].join("")}t.exports=n},5652:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container py-5"},[e("AdminNav"),e("form",{staticClass:"my-4"},[e("div",{staticClass:"form-row"},[e("div",{staticClass:"col-auto"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newCatgoryName,expression:"newCatgoryName"}],staticClass:"form-control",attrs:{type:"text",placeholder:"新增餐廳類別..."},domProps:{value:t.newCatgoryName},on:{input:function(e){e.target.composing||(t.newCatgoryName=e.target.value)}}})]),e("div",{staticClass:"col-auto"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.createCategory.apply(null,arguments)}}},[t._v(" 新增 ")])])])]),e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.categories,(function(a){return e("tr",{key:a.id},[e("th",{attrs:{scope:"row"}},[t._v(" "+t._s(a.id)+" ")]),e("td",{staticClass:"position-relative"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!a.isEditing,expression:"!category.isEditing"}],staticClass:"category-name"},[t._v(" "+t._s(a.name)+" ")]),e("input",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"},{name:"model",rawName:"v-model",value:a.name,expression:"category.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:a.name},on:{input:function(e){e.target.composing||t.$set(a,"name",e.target.value)}}}),e("span",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"}],staticClass:"cancel",on:{click:function(e){return t.handleCancel(a.id)}}},[t._v(" ✕ ")])]),e("td",{staticClass:"d-flex justify-content-between"},[e("button",{directives:[{name:"show",rawName:"v-show",value:!a.isEditing,expression:"!category.isEditing"}],staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleIsEditing(a.id)}}},[t._v(" Edit ")]),e("button",{directives:[{name:"show",rawName:"v-show",value:a.isEditing,expression:"category.isEditing"}],staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.updateCategory({categoryId:a.id,name:a.name})}}},[t._v(" Save ")]),e("button",{staticClass:"btn btn-link mr-2",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteCategory(a.id)}}},[t._v(" Delete ")])])])})),0)])],1)},n=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{attrs:{scope:"col",width:"60"}},[t._v(" # ")]),e("th",{attrs:{scope:"col"}},[t._v(" Category Name ")]),e("th",{attrs:{scope:"col",width:"210"}},[t._v(" Action ")])])])}],s=(a("d9e2"),a("e04c")),i=a("c64e"),o=a.n(i),c=a("be6c"),u=a("2fa3"),d={components:{AdminNav:s["a"]},data(){return{newCatgoryName:"",categories:[]}},created(){this.fetchCategories()},methods:{async fetchCategories(){try{const{data:t}=await c["a"].categories.get();this.categories=t.categories.map(t=>({...t,isEditing:!1,nameCached:""}))}catch(t){console.log("error",t),u["a"].fire({icon:"error",title:"無法取得資料，請稍後再試"})}},async createCategory(){try{const t={id:o()(),name:this.newCatgoryName},{data:e}=await c["a"].categories.create({name:t});if(console.log(e),"error"===e.status)throw new Error(e.message);this.newCatgoryName="",this.fetchCategories()}catch(t){console.log("error",t),u["a"].fire({icon:"warning",title:"無法新增類別，請稍後再試"})}},async deleteCategory(t){try{const{data:e}=await c["a"].categories.delete({categoryId:t});if("error"===e.status)throw new Error(e.message);this.fetchCategories()}catch(e){console.log("error",e),u["a"].fire({icon:"warning",title:"無法刪除類別，請稍後再試"})}},async updateCategory({categoryId:t,name:e}){try{const{data:a}=await c["a"].categories.update({categoryId:t,name:{name:e}});if("error"===a.status)throw new Error(a.message);this.toggleIsEditing(t)}catch(a){console.log("error",a),u["a"].fire({icon:"warning",title:"無法更新類別，請稍後再試"})}},toggleIsEditing(t){this.categories=this.categories.map(e=>e.id===t?{...e,isEditing:!e.isEditing,nameCached:e.name}:e)},handleCancel(t){this.categories=this.categories.map(e=>e.id===t?{...e,name:e.nameCached}:e),this.toggleIsEditing(t)}}},l=d,g=(a("2163"),a("2877")),m=Object(g["a"])(l,r,n,!1,null,"3e45080f",null);e["default"]=m.exports},"8cb0":function(t,e){},be6c:function(t,e,a){"use strict";var r=a("2fa3");e["a"]={categories:{get(){return r["b"].get("/admin/categories")},create({data:t}){return r["b"].post("/admin/categories",t)},update({categoryId:t,name:e}){return r["b"].put("/admin/categories/"+t,e)},delete({categoryId:t}){return r["b"].delete("/admin/categories/"+t)}},restaurants:{getDetail({restaurantId:t}){return r["b"].get("/admin/restaurants/"+t)},create({formData:t}){return r["b"].post("/admin/restaurants",t)},get(){return r["b"].get("/admin/restaurants")},delete({restaurantId:t}){return r["b"].delete("/admin/restaurants/"+t)},update({restaurantId:t,formData:e}){return r["b"].put("/admin/restaurants/"+t,e)}},getUsers(){return r["b"].get("/admin/users")},updateCurrentUser({userId:t,isAdmin:e}){return r["b"].put("/admin/users/"+t,{isAdmin:e})}}},c64e:function(t,e,a){var r=a("e1f4"),n=a("2366");function s(t,e,a){var s=e&&a||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var o=0;o<16;++o)e[s+o]=i[o];return e||n(i)}t.exports=s},e04c:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mb-3"},[e("h1",[t._v("餐廳後台")]),e("router-link",{attrs:{to:"/admin/restaurants"}},[t._v("Restaurants")]),t._v(" | "),e("router-link",{attrs:{to:"/admin/categories"}},[t._v("Categories")]),t._v(" | "),e("router-link",{attrs:{to:"/admin/users"}},[t._v("Users")])],1)},n=[],s=a("2877"),i=a("8cb0"),o=a.n(i),c={},u=Object(s["a"])(c,r,n,!1,null,null,null);"function"===typeof o.a&&o()(u);e["a"]=u.exports},e1f4:function(t,e){var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(a){var r=new Uint8Array(16);t.exports=function(){return a(r),r}}else{var n=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),n[e]=t>>>((3&e)<<3)&255;return n}}},ee78:function(t,e,a){}}]);
//# sourceMappingURL=chunk-309a8f96.7f78dd48.js.map